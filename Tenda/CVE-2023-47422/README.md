## Vulnerabitily type
Incorrect Access Control

## Impact
Authentication bypass

## Vendor
Tenda

## Affected products
- Tenda TX9
	- Hardware version
		- V1
	- Firmware version
		- V22.03.02.54
- Tenda AX3
	- Hardware version
		- V3
	- Firmware version
		- V16.03.12.11
- Tenda AX9
	- Hardware version
		- V1
	- Firmware version
		- Â V22.03.01.46
- Tenda AX12
	- Hardware version
		- V1
	- Firmware version
		- V22.03.01.46

## Affected component
/usr/sbin/httpd

## Root cause
When user browses administration pages which require authentication, **httpd** will execute `R7WebsSecurityHandler`(`0x419718`) to validate if user have permission.
In the picture below, We can see that some of end points do not require authentication for access. For example, when user try to access **/favicon.ico**, he/she don't need to be an authenticated user.
Unfortunately, developer of `R7WebsSecurityHandler` uses a wrong way. Using `strstr` to match the file name may lead to **authentication bypass** in this case. 
An attacker can append **?img/main-logo.png** or **?reasy-ui-1.0.3.js** to the url to access any end point of **httpd** without authentication.
![image](https://github.com/xiaobye-ctf/My-CVE/assets/60853091/4aa41726-0188-43a3-a44c-1b9afdf82dbe)

## Acknowledgment
Reported by Xiaobye (@xiaobye_tw), graduate student from National Yang Ming Chiao Tung University, Dept. of CS, Security and Systems Lab.

